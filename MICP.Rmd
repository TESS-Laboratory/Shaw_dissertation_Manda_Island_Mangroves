---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

Import packages

```{r}
library(dplyr)
```
```{r}
library (readxl)
```
```{r}
library (tidyverse)
```

```{r}
library(ggplot2)
```

Import 1996 MICP data 

```{r}
mandaclipped1996 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/mandaclipped1996NEW.csv", header=TRUE)
mandaclipped1996
```
Rename 1996 area column 

```{r}
names(mandaclipped1996)[names(mandaclipped1996) == 'X1996area'] <- 'mangroves'
mandaclipped1996
```

Create a 1996 year 

```{r}
mandaclipped1996 <- cbind(mandaclipped1996, year="1996")
mandaclipped1996
```

Drop columns

```{r}
mandaclipped1996 = subset(mandaclipped1996,select = -c(PXLVAL, clipped2007data))
mandaclipped1996
```

Add 2007 MICP data 

```{r}
mandaclipped2007 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/Mandaclipped2007NEW.csv", header=TRUE)
mandaclipped2007
```

Rename 2007 area column 

```{r}
names(mandaclipped2007)[names(mandaclipped2007) == 'X2007'] <- 'mangroves'
mandaclipped2007
```
Create a 2007 year 

```{r}
mandaclipped2007 <- cbind(mandaclipped2007, year="2007")
mandaclipped2007
```
drop columns 

```{r}
mandaclipped2007 = subset(mandaclipped2007,select = -c(PXLVAL, clipped2007data))
mandaclipped2007
```
Import 2008 MICP data 

```{r}
mandaclipped2008 <- read_excel("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/MANDACLIP2008NEW.xls")
mandaclipped2008
```
Rename 2008 area column 

```{r}
names(mandaclipped2008)[names(mandaclipped2008) == '2008'] <- 'mangroves'
mandaclipped2008
```

Create 2008 year 

```{r}
mandaclipped2008 <- cbind(mandaclipped2008, year="2008")
mandaclipped2008
```

Drop columns 

```{r}
mandaclipped2008 = subset(mandaclipped2008,select = -c(PXLVAL, clipped2008))
mandaclipped2008
```

Import 2009 MICP data 

```{r}
mandaclipped2009 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/mandaclipped2009NEW.csv", header=TRUE)
mandaclipped2009
```
Rename 2009 area column 
```{r}
names(mandaclipped2009)[names(mandaclipped2009) == 'X2009are'] <- 'mangroves'
mandaclipped2009
```
Create 2009 year 

```{r}
mandaclipped2009 <- cbind(mandaclipped2009, year="2009")
mandaclipped2009
```

Drop Columns 

```{r}
mandaclipped2009 = subset(mandaclipped2009,select = -c(PXLVAL, clipped2009data))
mandaclipped2009
```

Import 2010 MICP data 

```{r}
mandaclipped2010 <- read_excel("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/MANDACLIP2010NEW.xls")
mandaclipped2010
```
Rename 2010 area column 

```{r}
names(mandaclipped2010)[names(mandaclipped2010) == '2010area'] <- 'mangroves'
mandaclipped2010
```
```{r}
names(mandaclipped2010)[names(mandaclipped2010) == '2010clippedlamu'] <- 'delete'
mandaclipped2010
```
Create 2010 year

```{r}
mandaclipped2010 <- cbind(mandaclipped2010, year="2010")
mandaclipped2010
```
Drop columns 
```{r}
mandaclipped2010 = subset(mandaclipped2010,select = -c(PXLVAL, delete))
mandaclipped2010
```
Import 2015 MICP data 

```{r}
mandaclipped2015 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/mandaclipped2015NEW.csv", header=TRUE)
mandaclipped2015
```
Rename 2015 area column 

```{r}
names(mandaclipped2015)[names(mandaclipped2015) == 'X2015area'] <- 'mangroves'
mandaclipped2015
```
Create 2015 year
```{r}
mandaclipped2015 <- cbind(mandaclipped2015, year="2015")
mandaclipped2015
```
Drop columns 
```{r}
mandaclipped2015 = subset(mandaclipped2015,select = -c(PXLVAL, X2015lamuclipped))
mandaclipped2015
```
Import 2016 MICP Data
```{r}
mandaclipped2016 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/Mandaclipped2016new.csv", header=TRUE)
mandaclipped2016
```
Rename 2016 area column 

```{r}
names(mandaclipped2016)[names(mandaclipped2016) == 'X2016area'] <- 'mangroves'
mandaclipped2016
```
Create 2016 year 
```{r}
mandaclipped2016 <- cbind(mandaclipped2016, year="2016")
mandaclipped2016
```

Drop Columns 
```{r}
mandaclipped2016 = subset(mandaclipped2016,select = -c(PXLVAL, X2016clippedlamu))
mandaclipped2016
```

Import 2017 MICP Data 
```{r}
mandaclipped2017 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/Mandaclipped2017NEW.csv", header=TRUE)
mandaclipped2017
```

Rename area column 
```{r}
names(mandaclipped2017)[names(mandaclipped2017) == 'X2017AREA'] <- 'mangroves'
mandaclipped2017
```

Creat 2017 Year column 
```{r}
mandaclipped2017 <- cbind(mandaclipped2017, year="2017")
mandaclipped2017
```

Drop columns

```{r}
mandaclipped2017 = subset(mandaclipped2017,select = -c(PXLVAL, X2019))
mandaclipped2017
```

Import 2018 MICP Data 
```{r}
mandaclipped2018 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/mandaclipped2018NEW.csv", header=TRUE)
mandaclipped2018
```
Rename 2018 area column 

```{r}
names(mandaclipped2018)[names(mandaclipped2018) == 'X2018area'] <- 'mangroves'
mandaclipped2018
```
Create 2018 year 

```{r}
mandaclipped2018 <- cbind(mandaclipped2018, year="2018")
mandaclipped2018
```
Delete columns 

```{r}
mandaclipped2018 = subset(mandaclipped2018,select = -c(PXLVAL))
mandaclipped2018
```
Import 2019 MICP Data 

```{r}
mandaclipped2019 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/mandaclipped2019NEW.csv", header=TRUE)
mandaclipped2019
```
Rename 2019 area 

```{r}
names(mandaclipped2019)[names(mandaclipped2019) == 'X2009'] <- 'mangroves'
mandaclipped2019
```
Create 2019 Year 

```{r}
mandaclipped2019 <- cbind(mandaclipped2019, year="2019")
mandaclipped2019
```
Delete columns 

```{r}
mandaclipped2019 = subset(mandaclipped2019,select = -c(PXLVAL, clipped2019))
mandaclipped2019
```

Import 2020 MICP Data 

```{r}
mandaclipped2020 <- read.csv("~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/Global Mangrove Watch Datasets /CSV Lamu Clipped Data files/MANDACLIPPEDDATA/Manda2020new.csv", header=TRUE)
mandaclipped2020
```
Rename 2010 area column 

```{r}
names(mandaclipped2020)[names(mandaclipped2020) == 'X2020area'] <- 'mangroves'
mandaclipped2020
```
Create 2020 year 

```{r}
mandaclipped2020 <- cbind(mandaclipped2020, year="2020")
mandaclipped2020
```
Delete columns 

```{r}
mandaclipped2020 = subset(mandaclipped2020,select = -c(PXLVAL, lamu2020))
mandaclipped2020
```
Combine all MICP Dataframes 

```{r}
df2 <- bind_rows(mandaclipped1996, mandaclipped2007, mandaclipped2008, mandaclipped2009, mandaclipped2010, mandaclipped2015, mandaclipped2016, mandaclipped2017, mandaclipped2018, mandaclipped2019, mandaclipped2020)
df2
```
Check unique values 

```{r}
unique(df2$year)
```

Group by year

```{r}
agg_tbl <- df2 %>% group_by(year) %>% summarise(total_mangroves=sum(mangroves),.groups = 'drop')
agg_tbl
```

Convert to a dataframe 

```{r}
df3 <- agg_tbl %>% as.data.frame()
df3
```
Convert to hectares

```{r}
df3$total_mangroves_hectares <- df3$total_mangroves / 10000
df3
```
Duplicate dataset 

```{r}
df4 <- df3
df4
```
Make a bar plot 

```{r}

# Uniform color
barplot(height=df4$total_mangroves_hectares, names=df4$year, 
        col=rgb(0.8,0.1,0.1,0.6),
        xlab="Year", 
        ylab="Hectares", 
        main="Manda Island Conservancy mangrove cover 1996 to 2020", 
        ylim=c(0,200)
        )
```
Create a time series

```{r}
df4 %>%
  ggplot( aes(x=year, y=total_mangroves_hectares, group=1)) +
    geom_line() +
    geom_point() +
  ylim(0, 200)

```

Export 

```{r}
write.csv(df4, "~/Library/CloudStorage/OneDrive-UniversityofExeter/Global Sustainability Solutions/Dissertation/R/manda1996-2020.csv", row.names=FALSE)
```


